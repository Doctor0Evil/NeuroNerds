name: Swarmnet_Scale_Generation

on:
  workflow_dispatch:

jobs:
  generate_large_context:
    runs-on: ubuntu-latest
    env:
      OUTPUT_DIR: swarmnet_output
      DOCS_FILE: full_context_docs.txt
      SAI_FILE: instructions.sai
      MAI_PARTICLE_FILE: particle.mai
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v3

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install Requirements
        run: |
          python -m pip install --upgrade pip
          pip install some-large-text-generator-lib  # Replace with your specific generator libs

      - name: Generate Large Context Docs
        run: |
          mkdir -p $OUTPUT_DIR
          python scripts/generate_docs.py --output $OUTPUT_DIR/$DOCS_FILE --target-size 4000000

      - name: Generate .sai Configuration
        run: |
          python scripts/generate_sai.py --output $OUTPUT_DIR/$SAI_FILE --context $OUTPUT_DIR/$DOCS_FILE

      - name: Generate .mai Particle Files
        run: |
          python scripts/generate_mai.py --output $OUTPUT_DIR/$MAI_PARTICLE_FILE --context $OUTPUT_DIR/$DOCS_FILE

      - name: Commit and Push Generated Files
        run: |
          git config user.name "SwarmBot"
          git config user.email "swarmbot@example.com"
          git add $OUTPUT_DIR/*
          git commit -m "Autogenerated large context files for Swarmnet setup"
          git push

      - name: Output Summary
        run: |
          echo "Generated files:"
          ls -lh $OUTPUT_DIR
